# 1장 테스트주도개발 Test Driven Development



## 흔하디 흔한 소프트웨어 개발 상식
일반적으로 '소프트웨어 개발'이라는 직업은 특정한 무언가가 불편한거나 필요하다든가, 또는 어떤 것이 잘못되었다든가 하는 식의 '문제영역'이 시발점이 된다. 그리고 개발자는 본인의 의지든 타인의 권유든 여러 가지의 이유로 그 문제를 해결하기 위해 '기능을 구현'한다. 그리고 일정 시점이 지나면 구현의 '검증'을 위한 테스트를 한다.(대표적으로 콘솔(Console)을 이용하여 화면에 값을 확인해 기능들이 정상적으로 잘 잘동하는지, 원하는 값들이 잘 출력이 됬는지, 혹은 문제가 있는 지 없는지를 개발자는 판단한다.)

하지만 개발자는 사람이고, 사람은 상황에 따라 다르게 반응하고 보여주는 효율도 늘 다르다.
개발이란 업무는 개인의 지식기능을 최대한으로 발휘해야 하는 작업 중 하나이다. 따라서 개발자는 개발을 잘하기 위해 본인 스스로에게 맞는 집중환경을 찾아야한다. 하지만 늘 집중 환경이 이뤄질 수 없다. 이유는 다양하다.

- 전날 크게 회식하고 출근한 후, 집중이 안될 때
- 그냥 컨디션이 안좋아서 아무것도 안될 때
- 여자친구와 헤어졌을 때

위와 같은 상황속이라면 머리가 매우 복잡할 것이다. 하지만 저런 이유로 개발을 안할 순 없다. 개발자는 어떻게해서든 개발을 해야한다. 개발을 어느정도 끝내고 간단한 테스트를 하고나서 개발이 끝났다고 생각한다. 이런 식으로 '작성자의 판단'에 근거한 개발은 개발자의 컨디션에 따라 달라진다. 

'작성자의 판단' 즉 개발자의 주관적인 판단에 의존한 개발은 아래와 같은 문제점을이 나타난다.

### 1. 특정 모듈의 개발 기간이 길어질수록 개발자의 목표의식이 흐려진다.
- 어디까지 짰더라?
- 아, 내가 지금 뭘 하는 거였지?
- 이 모듈이 무슨 기능을 해야 한댔더라?

### 2. 작업 분량이 늘어날수록 확인이 어려워진다.
- 로그가 어디 있더라?
- 이것도 화면으로 출력해보고...

### 3. 개발자의 집중력이 필요해진다.
- 앗! 화면 지나갔다!

### 4. 논리적인 오류를 찾기가 어렵다.
- 여기서 그러니깐 이 값이 들어가면 나와야 하는 게...아.. 이거 아닌가?

### 5. 코드의 사용 방법과 변경 이력을 개발자의 기억력에 의존하게 되는 경우가 많다.
- 맞아! 개인고객 인증을 고치면 법인 고객인증 부분도 함께 고쳤어야 했었지!!

### 6. 테스트 케이스가 적혀 있는 엑셀 파일을 보며 매번 테스트를 실행하는 게 점점 귀찮아져서 점차 간소화하는 항목이 늘어난다.
- 날짜? 1111. 주민번호? 우선 222222-22222222. 주소? 서울 대충해~

### 7. 코드 수정 시에 기존 코드의 정상 동작에 대한 보장이 어렵다.
- 아 고칠 곳을 찾았다!. 근데 이 모듈을 다른 데서도 쓰지 않을까..?

### 8. 테스트를 해보려면 소스코드에 변경을 가하는 등, 번거러운 선행 작업이 필요할 수 있다.
- 입고 처리를 테스트하려면, DB에서 입고 처리 테이블을 직접 업데이트 해줘야...
### 9. 소스 변경 시 해야하는 회귀 테스트는 곧잘 회귀 테스트가 되기 쉽다.
- 소스 변경한 것만 테스트한 후, 기존에 잘 작동하던 테스트 코드를 다시 테스트하지않고 잘 돌아갈꺼라 믿는...
### 10. 이래저래 테스트는 개발자의 귀중한 노동력을 적지 않게 소모한다.
- 코드의 양이 많으면 많을수록 개발자가 테스트해야할 일은 산더미처럼 증가한다.


## 테스트 주도 개발(TDD)
> 프로그램을 작성하기 전에 테스트 먼저 하라!(Test the program before you write it)

TDD의 정의는 "업무 코드를 작성하기 전에 테스트 코드를 먼저 만드는 것!" 라고 한다.

TDD는 메소드나, 함수 같은 프로그램 모듈을 작성할 때 '작성 종료조건을 먼저 정해놓고 코딩을 시작한다'라는 의미이다.

## 테스트 주도 개발의 목표
> 잘 동작하는 깔끔한 코드(Clean code that works)

TDD에선 정상적으로 동작하는 코드만을 개발하는 것이 목표가 아니라, 작성된 코드도 명확한 의미를 전달할 수 있게 작성되어야 한다라고 말한다.
즉 **'제대로 동작함(work)'**뿐 아니라 **'깔금함'** 을 목표로 한다.

## 개발에 있어 테스트 주도 개발의 위치
> 개발자가 처음으로 수행하는 테스트

TDD에서 말하는 테스트는 일반적으로 메소드 단위의 테스트를 뜻한다.
개발자는 자신이 작성한 프로그램에 대해 메소드 혹은 함수 단위로 테스트를 수행하며, 이는 결과적으로 이후에 발생하는 테스트 단계에서의 결함발생 비용을 줄어든다. 즉 규모가 큰 프로젝트일수록 더더욱 TDD 개발론은 빛을 발휘한다는 의미이다.

## 테스트 주도 개발의 진행 방식
> **질문(Ask)** : 테스트 작성을 통해 시스템에 질문한다. (테스트 수행 결과는 실패) -> **RED**
> **응답(Respond)** : 테스트를 통과하는 코드를 작성해서 질문에 대답한다. (테스트 성공) - > **GREEN**
> **정제(Refine)** : 아이디어를 통합하고, 불필요한 것은 제거하고, 모호한 것은 명확히 해서 대답을 정제한다. (리펙토링) -> **REFACTOR**
> **반복(Repeat)** : 다음 질문을 통해 위 과정을 반복한다.


여기서 질문은 말그대로 실패 케이스를 작성하는 것이다.
실패 케이스를 작성한 후 컴퓨터에게 물어본다 이 코드가 정상적으로 작동할 수 있을까?라고
그럼 컴퓨터는 개발자에게 응답을 해줄 것이다. 이러한 코드는 내가 알아볼 수 없으니 알아볼 수 있게 만들어줘 라는 방식으로

개발자는 컴퓨터로부터 응답받은 내용을 토대로 다시 질문을 작성한다.
너가 원하는 대로 만들었으니 잘돌아가는 지 확인해줄래? 여기서 통과를 하면 개발자는 리펙토링 과정을 거치고, 만약 실패하면 다시 컴퓨터가 알아볼 수 있게끔 코드를 작성해야한다.


출처 : [TDD 실천법과 도구](https://repo.yona.io/doortts/blog/issue/1)



